<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <record id="view_user_group_transfer_wizard" model="ir.ui.view">
    <field name="name">user.group.transfer.wizard.form</field>
    <field name="model">user.group.transfer.wizard</field>
    <field name="arch" type="xml">
      <form string="User Group Transfer">
        <sheet>
          <group>
            <field name="mode"/>
            <field name="scope"/>
          </group>

          <!-- EXPORT: scope=user -->
          <group invisible="not (mode == 'export' and scope == 'user')">
            <field name="user_ids" widget="many2many_tags"/>
            <field name="include_inactive"/>
            <button string="Export" name="action_export" type="object" class="btn-primary oe_highlight"/>
            <field name="export_filename" readonly="1" invisible="not export_file"/>
            <field name="export_file" filename="export_filename" invisible="not export_file"/>
          </group>

          <!-- EXPORT: scope=group -->
          <group invisible="not (mode == 'export' and scope == 'group')">
            <field name="group_ids" widget="many2many_tags" placeholder="Biarkan kosong untuk semua groups"/>
            <button string="Export" name="action_export" type="object" class="btn-primary oe_highlight"/>
            <field name="export_filename" readonly="1" invisible="not export_file"/>
            <field name="export_file" filename="export_filename" invisible="not export_file"/>
          </group>

          <!-- IMPORT (berlaku untuk keduanya; wizard deteksi dari payload.type atau scope) -->
          <group invisible="mode != 'import'">
            <field name="import_filename"/>
            <field name="import_file" filename="import_filename"/>
            <button string="Import" name="action_import" type="object" class="btn-primary oe_highlight"/>
          </group>
        </sheet>
      </form>
    </field>
  </record>

  <record id="action_user_group_transfer_wizard" model="ir.actions.act_window">
    <field name="name">Base</field>
    <field name="res_model">user.group.transfer.wizard</field>
    <field name="view_mode">form</field>
    <field name="target">new</field>
    <field name="context">{'default_mode': 'export', 'default_scope': 'user'}</field>
  </record>

  <menuitem id="menu_user_group_transfer_root"
            name="Base"
            parent="base.menu_users"
            action="action_user_group_transfer_wizard"
            sequence="60"/>
</odoo>
